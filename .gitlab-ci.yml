include:
  - project: "IONDEV/tacklebox"
    file: "gitlab_ci_templates/pre-commit.yml"

stages:
  - build

pre-commit checks:
  extends:
    - .tacklebox pre-commit
  stage: .pre


.pages:
  stage: build
  image: ${CI_REGISTRY}/traque/ont-docker-base/ont-base-python:3.10
  needs: []
  tags:
    - linux
  script:
    - pip install -r ./requirements.txt
    - export ONT_SPECIFICATION_VERSION=$(python find_current_version.py)
    - export PYTHONPATH=./docs/mkdocs_extensions/
    - mkdocs build --strict --verbose --site-dir public
  artifacts:
    paths:
      - public

pages-test:
  extends:
    - .pages

pages:
  extends:
    - .pages
  rules:
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH # main branch
